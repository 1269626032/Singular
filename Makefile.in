SHELL		= /bin/sh

PRODUCT		= Singular
VERSION		= 1.0

DISTNAME	= ${PRODUCT}-full-${VERSION}

@SET_MAKE@
BUILD_SUBDIRS	= @CONFIG_SUBDIRS@
SUBDIRS		= @SUBDIRS@

TEMPDIR		= /tmp


all install uninstall info dvi : Makefile
	for SUBDIR in ${BUILD_SUBDIRS}; \
	do \
		echo ${MAKE} $@ in $${SUBDIR}; \
		cd $${SUBDIR}; \
		${MAKE} $@; \
		cd .. ;\
	done

clean distclean mostlyclean maintainer-clean: 
	for SUBDIR in ${SUBDIRS}; \
	do \
		echo ${MAKE} $@ in $${SUBDIR}; \
		cd $${SUBDIR}; \
		${MAKE} $@; \
		cd .. ;\
	done;\
	rm -rf *~ a.out core *.o .log lib bin share include; \
	if test "$@" = distclean || test "$@" = maintainer-clean; then \
	  rm -f config.cache config.log config.status TAGS* *.gz *.tar; \
	fi; \
	if test "$@" = maintainer-clean; then \
	  echo "This command is inteneded for maintainer use, only" ; \
	  echo "Rebuilding the deleteed file(s) requires at least autoconf"; \ 
	  rm -f configure ;\
	fi

dist: 
	rm -rf ${DISTNAME}.tar* ${TEMPDIR}/${DISTNAME}*
	mkdir ${TEMPDIR}/${DISTNAME}
	cp -pR . ${TEMPDIR}/${DISTNAME}
	cd ${TEMPDIR}/${DISTNAME}; ${MAKE} distclean; 
	- find ${TEMPDIR}/${DISTNAME} -name CVS -exec rm -rf {} \; 
	cd ${TEMPDIR}; tar cf ${DISTNAME}.tar ${DISTNAME} 
	rm -rf ${TEMPDIR}/${DISTNAME}
	gzip -9 ${TEMPDIR}/${DISTNAME}.tar
	- mv ${TEMPDIR}/${DISTNAME}.tar.gz .

Singular factory libfac MP gmp:
	cd $@; ${MAKE} all

check:
	cd Singular; ${MAKE} check
	
Makefile : Makefile.in config.status
	./config.status

config.status : configure
	./config.status --recheck

configure: configure.in
	echo "You need to rerun autoconf. I am proceeding, for now."
	touch configure
# 	autoconf 
#
