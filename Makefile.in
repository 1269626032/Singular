SHELL		= /bin/sh

SINGULAR_MAJOR_VERSION	= @SINGULAR_MAJOR_VERSION@
SINGULAR_MINOR_VERSION	= @SINGULAR_MINOR_VERSION@
SINGULAR_SUB_VERSION	= @SINGULAR_SUB_VERSION@
SINGULAR		= @SINGULAR@


@SET_MAKE@
BUILD_SUBDIRS	= @CONFIG_SUBDIRS@
SUBDIRS		= @SUBDIRS@

prefix 		= @prefix@
exec_prefix	= @exec_prefix@
bindir		= @bindir@

TEMPDIR		= /tmp


# default target
${SINGULAR}:
	${MAKE} install

# simply descend for these targets
all install uninstall: Makefile 
	for SUBDIR in ${BUILD_SUBDIRS}; \
	do \
	  echo ${MAKE} $@ in $${SUBDIR}; \
	  cd $${SUBDIR}; \
	  ${MAKE} $@; \
	  cd .. ;\
	done

# clean up in all subdirectories known to us
clean distclean mostlyclean maintainer-clean: 
	for SUBDIR in ${SUBDIRS}; \
	do \
	  echo ${MAKE} $@ in $${SUBDIR}; \
	  cd $${SUBDIR}; \
	  ${MAKE} $@; \
	  cd .. ;\
	done; \
	rm -rf *~ a.out core *.o *.log; \
	if test "$@" = distclean || test "$@" = maintainer-clean; then \
	  rm -rf Makefile config.cache config.log config.status TAGS* *.gz *.tar; \
	fi; \
	if test "$@" = maintainer-clean; then \
	  echo "This command is intended for maintainer use, only"; \
	  rm -rf configure;\
	fi

# some extra targets for the specific packages
Singular factory libfac MP gmp:
	cd $@; ${MAKE} all

# documentation
info dvi ps doc doc/singular.hlp: ${SINGULAR} 
	cd doc; ${MAKE} $@

info/singular.hlp:
	cd doc; ${MAKE} install

# remaking Makefile
Makefile: Makefile.in config.status
	./config.status

config.status: configure
	./config.status --recheck

configure: configure.in
	@echo "You need to rerun autoconf. I am proceeding, for now."
	@touch configure
# 	autoconf 
#
